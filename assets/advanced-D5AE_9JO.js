import{a as P,j as e,r as b,R as W}from"./client-DvaAtPIX.js";const q=t=>{let r;const s=new Set,n=(d,l)=>{const f=typeof d=="function"?d(r):d;if(!Object.is(f,r)){const u=r;r=l??(typeof f!="object"||f===null)?f:Object.assign({},r,f),s.forEach(j=>j(r,u))}},o=()=>r,m={setState:n,getState:o,getInitialState:()=>x,subscribe:d=>(s.add(d),()=>s.delete(d))},x=r=t(n,o,m);return m},_=t=>t?q(t):q,U=t=>t;function z(t,r=U){const s=P.useSyncExternalStore(t.subscribe,P.useCallback(()=>r(t.getState()),[t,r]),P.useCallback(()=>r(t.getInitialState()),[t,r]));return P.useDebugValue(s),s}const B=t=>{const r=_(t),s=n=>z(r,n);return Object.assign(s,r),s},V=t=>t?B(t):B;function J(t,r){let s;try{s=t()}catch{return}return{getItem:o=>{var a;const c=x=>x===null?null:JSON.parse(x,void 0),m=(a=s.getItem(o))!=null?a:null;return m instanceof Promise?m.then(c):c(m)},setItem:(o,a)=>s.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>s.removeItem(o)}}const T=t=>r=>{try{const s=t(r);return s instanceof Promise?s:{then(n){return T(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return T(n)(s)}}}},Q=(t,r)=>(s,n,o)=>{let a={storage:J(()=>localStorage),partialize:g=>g,version:0,merge:(g,w)=>({...w,...g}),...r},c=!1;const m=new Set,x=new Set;let d=a.storage;if(!d)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...g)},n,o);const l=()=>{const g=a.partialize({...n()});return d.setItem(a.name,{state:g,version:a.version})},f=o.setState;o.setState=(g,w)=>(f(g,w),l());const u=t((...g)=>(s(...g),l()),n,o);o.getInitialState=()=>u;let j;const v=()=>{var g,w;if(!d)return;c=!1,m.forEach(i=>{var p;return i((p=n())!=null?p:u)});const h=((w=a.onRehydrateStorage)==null?void 0:w.call(a,(g=n())!=null?g:u))||void 0;return T(d.getItem.bind(d))(a.name).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==a.version){if(a.migrate){const p=a.migrate(i.state,i.version);return p instanceof Promise?p.then(N=>[!0,N]):[!0,p]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,i.state];return[!1,void 0]}).then(i=>{var p;const[N,k]=i;if(j=a.merge(k,(p=n())!=null?p:u),s(j,!0),N)return l()}).then(()=>{h?.(j,void 0),j=n(),c=!0,x.forEach(i=>i(j))}).catch(i=>{h?.(void 0,i)})};return o.persist={setOptions:g=>{a={...a,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>c,onHydrate:g=>(m.add(g),()=>{m.delete(g)}),onFinishHydration:g=>(x.add(g),()=>{x.delete(g)})},a.skipHydration||v(),j||u},D=Q,G=(t,r)=>r.discountType==="amount"?Math.max(0,t-r.discountValue):Math.round(t*(1-r.discountValue/100)),K=(t,r)=>t.discountType==="percentage"&&r<1e4?"percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.":null,X=(t,r)=>{const{discounts:s}=t.product,{quantity:n}=t,o=s.reduce((c,m)=>n>=m.quantity&&m.rate>c?m.rate:c,0);return r.some(c=>c.quantity>=10)?Math.min(o+.05,.5):o},$=(t,r)=>{const{price:s}=t.product,{quantity:n}=t,o=X(t,r);return Math.round(s*n*(1-o))},Y=(t,r)=>{let s=0,n=0;return t.forEach(o=>{const a=o.product.price*o.quantity;s+=a,n+=$(o,t)}),r&&(n=G(n,r)),{totalBeforeDiscount:Math.round(s),totalAfterDiscount:Math.round(n)}},Z=(t,r,s)=>s<=0?t.filter(n=>n.product.id!==r):t.map(n=>n.product.id===r?{...n,quantity:s}:n),F=(t,r)=>{const s=r.find(o=>o.product.id===t.id);return t.stock-(s?.quantity||0)},ee=(t,r)=>{if(!r||r.trim()==="")return t;const s=r.toLowerCase();return t.filter(n=>{const o=n.name.toLowerCase().includes(s),a=n.description&&n.description.toLowerCase().includes(s);return o||a})},te=3e3,y=V(t=>({notifications:[],addNotification:(r,s="success")=>{const n=Date.now().toString(),o={id:n,message:r,type:s};t(a=>({notifications:[...a.notifications,o]})),setTimeout(()=>{t(a=>({notifications:a.notifications.filter(c=>c.id!==n)}))},te)},removeNotification:r=>{t(s=>({notifications:s.notifications.filter(n=>n.id!==r)}))},setNotifications:r=>{t({notifications:r})},reset:()=>{t({notifications:[]})}})),R=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],E=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],M=V()(D(t=>({products:R,addProduct:r=>{const s={...r,id:`p${Date.now()}`};t(n=>({products:[...n.products,s]})),y.getState().addNotification("상품이 추가되었습니다.","success")},updateProduct:(r,s)=>{t(n=>({products:n.products.map(o=>o.id===r?{...o,...s}:o)})),y.getState().addNotification("상품이 수정되었습니다.","success")},deleteProduct:r=>{t(s=>({products:s.products.filter(n=>n.id!==r)})),y.getState().addNotification("상품이 삭제되었습니다.","success")},setProducts:r=>{t({products:r})},reset:()=>{t({products:R})}}),{name:"products"})),C=V()(D((t,r)=>({cart:[],totalItemCount:0,calculateItemTotal:s=>$(s,r().cart),calculateCartTotal:s=>Y(r().cart,s),getRemainingStock:s=>F(s,r().cart),addToCart:s=>{const n=r().cart,o=F(s,n),a=y.getState().addNotification;if(o<=0){a("재고가 부족합니다!","error");return}let c;const m=n.find(x=>x.product.id===s.id);if(m){const x=m.quantity+1;if(x>s.stock){a(`재고는 ${s.stock}개까지만 있습니다.`,"error");return}c=n.map(d=>d.product.id===s.id?{...d,quantity:x}:d)}else c=[...n,{product:s,quantity:1}];t(()=>{const x=c.reduce((d,l)=>d+l.quantity,0);return{cart:c,totalItemCount:x}}),a("장바구니에 담았습니다","success")},removeFromCart:s=>{t(n=>{const o=n.cart.filter(c=>c.product.id!==s),a=o.reduce((c,m)=>c+m.quantity,0);return{cart:o,totalItemCount:a}})},updateQuantity:(s,n)=>{const o=M.getState().products,a=y.getState().addNotification,c=o.find(x=>x.id===s);if(!c)return;const m=c.stock;if(n>m){a(`재고는 ${m}개까지만 있습니다.`,"error");return}t(x=>{const d=Z(x.cart,s,n),l=d.reduce((f,u)=>f+u.quantity,0);return{cart:d,totalItemCount:l}})},completeOrder:s=>{const n=y.getState().addNotification,o=`ORD-${Date.now()}`;n(`주문이 완료되었습니다. 주문번호: ${o}`,"success"),t({cart:[],totalItemCount:0}),s&&s()},reset:()=>{t({cart:[],totalItemCount:0})}}),{name:"cart"})),O={searchTerm:""},L=V(t=>({...O,setSearchTerm:r=>t({searchTerm:r}),clearSearch:()=>t({searchTerm:""}),reset:()=>t(O)})),se=({isAdmin:t,setIsAdmin:r})=>{const s=C(c=>c.cart),n=C(c=>c.totalItemCount),o=L(c=>c.searchTerm),a=L(c=>c.setSearchTerm);return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!t&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:o,onChange:c=>a(c.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>r(!t),className:`px-3 py-1.5 text-sm rounded transition-colors ${t?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:t?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!t&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),s.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:n})]})]})]})})})},re=({item:t,calculateItemTotal:r,onRemove:s,onUpdateQuantity:n})=>{const o=r(t),a=t.product.price*t.quantity,c=o<a,m=c?Math.round((1-o/a)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:t.product.name}),e.jsx("button",{onClick:()=>s(t.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>n(t.product.id,t.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:t.quantity}),e.jsx("button",{onClick:()=>n(t.product.id,t.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[c&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",m,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(o).toLocaleString(),"원"]})]})]})]})},ne=({coupons:t,selectedCoupon:r,onApplyCoupon:s,onClearCoupon:n})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:r?.code||"",onChange:o=>{const a=t.find(c=>c.code===o.target.value);a?s(a):n()},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(o=>e.jsxs("option",{value:o.code,children:[o.name," (",o.discountType==="amount"?`${o.discountValue.toLocaleString()}원`:`${o.discountValue}%`,")"]},o.code))]})]}),oe=({totals:t,onCompleteOrder:r})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[t.totalBeforeDiscount.toLocaleString(),"원"]})]}),t.totalBeforeDiscount-t.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(t.totalBeforeDiscount-t.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[t.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:r,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[t.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]}),S=V()(D((t,r)=>({coupons:E,selectedCoupon:null,addCoupon:s=>{const{coupons:n}=r();if(n.find(a=>a.code===s.code)){y.getState().addNotification("이미 존재하는 쿠폰 코드입니다.","error");return}t(a=>({coupons:[...a.coupons,s]})),y.getState().addNotification("쿠폰이 추가되었습니다.","success")},applyCoupon:(s,n)=>{const o=K(s,n);if(o){y.getState().addNotification(o,"error");return}t({selectedCoupon:s}),y.getState().addNotification("쿠폰이 적용되었습니다.","success")},deleteCoupon:s=>{const{selectedCoupon:n}=r();t(o=>({coupons:o.coupons.filter(a=>a.code!==s),selectedCoupon:n?.code===s?null:n})),y.getState().addNotification("쿠폰이 삭제되었습니다.","success")},setSelectedCoupon:s=>{t({selectedCoupon:s})},setCoupons:s=>{t({coupons:s})},reset:()=>{t({coupons:E,selectedCoupon:null})}}),{name:"coupons"})),ae=()=>{const t=C(u=>u.cart),r=S(u=>u.coupons),s=S(u=>u.selectedCoupon),n=S(u=>u.applyCoupon),o=S(u=>u.setSelectedCoupon),a=C(u=>u.calculateItemTotal),c=C(u=>u.calculateCartTotal),m=C(u=>u.removeFromCart),x=C(u=>u.updateQuantity),d=C(u=>u.completeOrder),l=c(s),f=b.useCallback(()=>{d(()=>{o(null)})},[d,o]);return e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:t.map(u=>e.jsx(re,{item:u,calculateItemTotal:a,onRemove:m,onUpdateQuantity:x},u.product.id))})]}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{coupons:r,selectedCoupon:s,onApplyCoupon:u=>n(u,l.totalBeforeDiscount),onClearCoupon:()=>o(null)}),e.jsx(oe,{totals:l,onCompleteOrder:f})]})]})})},A=(t,r,s=!1)=>t<=0?"SOLD_OUT":s?`${r.toLocaleString()}원`:`₩${r.toLocaleString()}`,ce=({product:t,remainingStock:r,onAddToCart:s})=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),t.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...t.discounts.map(n=>n.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:A(r,t.price)}),t.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[t.discounts[0].quantity,"개 이상 구매시 할인 ",t.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[r<=5&&r>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",r,"개 남음"]}),r>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",r,"개"]})]}),e.jsx("button",{onClick:()=>s(t),disabled:r<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${r<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:r<=0?"품절":"장바구니 담기"})]})]});function ie(t,r){const[s,n]=b.useState(t);return b.useEffect(()=>{const o=setTimeout(()=>{n(t)},r);return()=>{clearTimeout(o)}},[t,r]),s}const de=()=>{const t=L(c=>c.searchTerm),r=ie(t,500),s=M(c=>c.products),n=ee(s,r),o=C(c=>c.getRemainingStock),a=C(c=>c.addToCart);return e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",s.length,"개 상품"]})]}),n.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',r,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(c=>e.jsx(ce,{product:c,remainingStock:o(c),onAddToCart:a},c.id))})]})})},le=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx(de,{}),e.jsx(ae,{})]}),ue=(t,r)=>{if(t==="percentage"){if(r>100)return{isValid:!1,errorMessage:"할인율은 100%를 초과할 수 없습니다",correctedValue:100};if(r<0)return{isValid:!1,correctedValue:0}}else{if(r>1e5)return{isValid:!1,errorMessage:"할인 금액은 100,000원을 초과할 수 없습니다",correctedValue:1e5};if(r<0)return{isValid:!1,correctedValue:0}}return{isValid:!0}},me=t=>t<0?{isValid:!1,errorMessage:"가격은 0보다 커야 합니다",correctedValue:0}:{isValid:!0},xe=t=>t<0?{isValid:!1,errorMessage:"재고는 0보다 커야 합니다",correctedValue:0}:t>9999?{isValid:!1,errorMessage:"재고는 9999개를 초과할 수 없습니다",correctedValue:9999}:{isValid:!0},I=t=>t===""||/^\d+$/.test(t),he=({addProduct:t,updateProduct:r})=>{const s=y(h=>h.addNotification),[n,o]=b.useState(!1),[a,c]=b.useState(null),[m,x]=b.useState({name:"",price:0,stock:0,description:"",discounts:[]}),d=b.useCallback(()=>{x({name:"",price:0,stock:0,description:"",discounts:[]}),c(null),o(!1)},[]),l=b.useCallback(h=>{c(h.id),x({name:h.name,price:h.price,stock:h.stock,description:h.description||"",discounts:h.discounts||[]}),o(!0)},[]),f=b.useCallback(()=>{x({name:"",price:0,stock:0,description:"",discounts:[]}),c("new"),o(!0)},[]),u=b.useCallback(h=>{h.preventDefault(),a&&a!=="new"?r(a,m):t({...m,discounts:m.discounts}),d()},[a,m,t,r,d]),j=b.useCallback(h=>{I(h)&&x(i=>({...i,price:h===""?0:parseInt(h)}))},[]),v=b.useCallback(h=>{if(h==="")x(i=>({...i,price:0}));else{const i=parseInt(h),p=me(i);!p.isValid&&p.correctedValue!==void 0&&(p.errorMessage&&s(p.errorMessage,"error"),x(N=>({...N,price:p.correctedValue})))}},[s]),g=b.useCallback(h=>{I(h)&&x(i=>({...i,stock:h===""?0:parseInt(h)}))},[]),w=b.useCallback(h=>{if(h==="")x(i=>({...i,stock:0}));else{const i=parseInt(h),p=xe(i);!p.isValid&&p.correctedValue!==void 0&&(p.errorMessage&&s(p.errorMessage,"error"),x(N=>({...N,stock:p.correctedValue})))}},[s]);return{showProductForm:n,setShowProductForm:o,editingProduct:a,setEditingProduct:c,productForm:m,setProductForm:x,startEditProduct:l,startAddProduct:f,handleProductSubmit:u,handlePriceChange:j,handlePriceBlur:v,handleStockChange:g,handleStockBlur:w,resetForm:d}},ge=()=>{const t=C(i=>i.getRemainingStock),r=M(i=>i.products),s=M(i=>i.addProduct),n=M(i=>i.updateProduct),o=M(i=>i.deleteProduct),{showProductForm:a,setShowProductForm:c,editingProduct:m,setEditingProduct:x,productForm:d,setProductForm:l,startEditProduct:f,startAddProduct:u,handleProductSubmit:j,handlePriceChange:v,handlePriceBlur:g,handleStockChange:w,handleStockBlur:h}=he({addProduct:s,updateProduct:n});return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(i=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:i.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A(t(i),i.price,!0)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.stock>10?"bg-green-100 text-green-800":i.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:i.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>f(i),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>o(i.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},i.id))})]})}),a&&e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:m==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:d.name,onChange:i=>l({...d,name:i.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:d.description,onChange:i=>l({...d,description:i.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:d.price===0?"":d.price,onChange:i=>v(i.target.value),onBlur:i=>g(i.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:d.stock===0?"":d.stock,onChange:i=>w(i.target.value),onBlur:i=>h(i.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[d.discounts.map((i,p)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:i.quantity,onChange:N=>{const k=[...d.discounts];k[p].quantity=parseInt(N.target.value)||0,l({...d,discounts:k})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:i.rate*100,onChange:N=>{const k=[...d.discounts];k[p].rate=(parseInt(N.target.value)||0)/100,l({...d,discounts:k})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const N=d.discounts.filter((k,H)=>H!==p);l({...d,discounts:N})},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},p)),e.jsx("button",{type:"button",onClick:()=>{l({...d,discounts:[...d.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{x(null),l({name:"",price:0,stock:0,description:"",discounts:[]}),c(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:m==="new"?"추가":"수정"})]})]})})]})},pe=({addCoupon:t})=>{const r=y(f=>f.addNotification),[s,n]=b.useState(!1),[o,a]=b.useState({name:"",code:"",discountType:"amount",discountValue:0}),c=b.useCallback(()=>{a({name:"",code:"",discountType:"amount",discountValue:0}),n(!1)},[]),m=b.useCallback(()=>{c(),n(!0)},[c]),x=b.useCallback(f=>{f.preventDefault(),t(o),c()},[o,t,c]),d=b.useCallback(f=>{I(f)&&a(u=>({...u,discountValue:f===""?0:parseInt(f)}))},[]),l=b.useCallback((f,u)=>{const j=parseInt(f)||0,v=ue(u,j);!v.isValid&&v.correctedValue!==void 0&&(v.errorMessage&&r(v.errorMessage,"error"),a(g=>({...g,discountValue:v.correctedValue})))},[r]);return{showCouponForm:s,setShowCouponForm:n,couponForm:o,setCouponForm:a,startAddCoupon:m,handleCouponSubmit:x,handleDiscountValueChange:d,handleDiscountValueBlur:l,resetForm:c}},fe=()=>{const t=S(l=>l.coupons),r=S(l=>l.addCoupon),s=S(l=>l.deleteCoupon),{showCouponForm:n,setShowCouponForm:o,couponForm:a,setCouponForm:c,handleCouponSubmit:m,handleDiscountValueChange:x,handleDiscountValueBlur:d}=pe({addCoupon:r});return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(l=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:l.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:l.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:l.discountType==="amount"?`${l.discountValue.toLocaleString()}원 할인`:`${l.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>s(l.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},l.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:()=>o(!n),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),n&&e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>c({...a,name:l.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:a.code,onChange:l=>c({...a,code:l.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:a.discountType,onChange:l=>c({...a,discountType:l.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:a.discountValue===0?"":a.discountValue,onChange:l=>x(l.target.value),onBlur:l=>d(l.target.value,a.discountType),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:a.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})]})]})},be=({activeTab:t,setActiveTab:r})=>e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>r("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${t==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>r("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${t==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),ye=()=>{const[t,r]=b.useState("products");return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx(be,{activeTab:t,setActiveTab:r}),t==="products"?e.jsx(ge,{}):e.jsx(fe,{})]})},je=()=>{const t=y(s=>s.notifications),r=y(s=>s.removeNotification);return!t||t.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:t.map(s=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${s.type==="error"?"bg-red-600":s.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:s.message}),e.jsx("button",{onClick:()=>r(s.id),className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s.id))})},Ne=()=>{const[t,r]=b.useState(!1);return e.jsxs("div",{className:"min-hx-screen bg-gray-50",children:[e.jsx(je,{}),e.jsx(se,{isAdmin:t,setIsAdmin:r}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:t?e.jsx(ye,{}):e.jsx(le,{})})]})};W.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(Ne,{})}));
